<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>weather</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="script.js">
    <style>
          *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        :root {
            --bg: #0b1020;
            --card: rgba(255, 255, 255, 0.08);
            --text: #f6f8ff;
            --muted: #cdd3ff;
            --accent: #7aa2ff;
            --ok: #4ade80;
            --warn: #fbbf24;
            --danger: #f87171;
            --shadow: 0 10px 30px rgba(0, 0, 0, .35);
            --radius: 16px;
        }

        html,
        body {
            height: 100%;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
            color: var(--text);
            background: linear-gradient(120deg, #0b1020, #101936 40%, #0e223f 100%);
            transition: background 600ms ease;
        }

        a {
            color: var(--accent);
            text-decoration: none;
        }

        /* --- Dynamic Background Themes --- */
        body.theme-clear {
            background: linear-gradient(120deg, #2a6ff0, #61c6ff);
        }

        body.theme-cloudy {
            background: linear-gradient(120deg, #485563, #29323c);
        }

        body.theme-rain {
            background: linear-gradient(120deg, #1f2937, #334155);
        }

        body.theme-thunder {
            background: linear-gradient(120deg, #1e293b, #0f172a);
        }

        body.theme-snow {
            background: linear-gradient(120deg, #6dd5ed, #ffffff);
            color: #0b1020;
        }

        body.theme-fog {
            background: linear-gradient(120deg, #bdc3c7, #2c3e50);
        }

        /* --- Navbar --- */
        .nav {
            position: sticky;
            top: 0;
            z-index: 9;
            backdrop-filter: blur(10px);
            background: linear-gradient(180deg, rgba(0, 0, 0, .35), rgba(0, 0, 0, 0));
            border-bottom: 1px solid rgba(255, 255, 255, .08);
        }

        .nav-inner {
            max-width: 1100px;
            margin: 0 auto;
            padding: 14px 18px;
            display: flex;
            gap: 16px;
            align-items: center;
            justify-content: space-between;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            letter-spacing: .3px;
        }

        .brand .logo {
            width: 28px;
            height: 28px;
            display: grid;
            place-items: center;
            background: var(--accent);
            color: #0b1020;
            border-radius: 8px;
            font-weight: 900;
            box-shadow: var(--shadow);
        }

        .quick-stats {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .chip {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--card);
            border: 1px solid rgba(255, 255, 255, .1);
            border-radius: 999px;
            font-size: 14px;
        }

        .chip .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--muted);
        }

        /* --- Search Row --- */
        .bar {
            max-width: 1100px;
            margin: 18px auto;
            padding: 0 18px;
            display: flex;
            gap: 10px;
        }

        .bar input {
            flex: 1;
            padding: 14px 16px;
            background: rgba(255, 255, 255, .12);
            border: 1px solid rgba(255, 255, 255, .18);
            border-radius: var(--radius);
            color: var(--text);
            outline: none;
        }

        .bar button {
            padding: 14px 16px;
            border: none;
            border-radius: var(--radius);
            background: var(--accent);
            color: #0b1020;
            font-weight: 700;
            cursor: pointer;
            box-shadow: var(--shadow);
        }

        .bar .ghost {
            background: transparent;
            color: var(--text);
            border: 1px solid rgba(255, 255, 255, .25);
        }

        /* --- Layout --- */
        .container {
            max-width: 1100px;
            margin: 10px auto 100px;
            padding: 0 18px;
            display: grid;
            gap: 18px;
            grid-template-columns: 1fr;
        }

        @media(min-width: 1000px) {
            .container {
                grid-template-columns: 1.2fr .8fr;
            }
        }

        .card {
            background: var(--card);
            border: 1px solid rgba(255, 255, 255, .12);
            border-radius: var(--radius);
            padding: 16px;
            box-shadow: var(--shadow);
        }

        .section-title {
            margin: 0 0 12px;
            font-size: 20px;
            letter-spacing: .2px;
            opacity: .9;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* --- Current Weather --- */
        .current {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 14px;
            align-items: center;
        }

        .hero-temp {
            font-size: 56px;
            font-weight: 800;
            line-height: .95;
        }

        .city-line {
            display: flex;
            align-items: center;
            gap: 10px;
            opacity: .9;
        }

        .meta {
            display: flex;
            gap: 14px;
            flex-wrap: wrap;
            font-size: 14px;
            opacity: .85;
        }

        /* --- Forecast grid --- */
        .grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        @media(min-width: 680px) {
            .grid {
                grid-template-columns: repeat(5, 1fr);
            }
        }

        .tile {
            background: rgba(255, 255, 255, .07);
            border: 1px solid rgba(255, 255, 255, .12);
            border-radius: 14px;
            padding: 12px;
            display: grid;
            gap: 6px;
        }

        .tile .day {
            font-weight: 700;
        }

        .tile .range {
            font-size: 14px;
            opacity: .9;
        }

        .tile .mini {
            font-size: 12px;
            opacity: .8;
        }

        /* --- Past days --- */
        .past-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        /* --- Sun times --- */
        .sun-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        @media(min-width: 680px) {
            .sun-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .sun-item {
            background: rgba(255, 255, 255, .07);
            border: 1px solid rgba(255, 255, 255, .12);
            border-radius: 14px;
            padding: 12px;
        }

        /* --- Icon style --- */
        .wx-icon {
            width: 52px;
            height: 52px;
        }

        .tile .wx-icon {
            width: 36px;
            height: 36px;
        }

        /* --- Footer note --- */
        .note {
            font-size: 12px;
            opacity: .7;
            text-align: center;
            margin: 18px 0 40px;
        }
    </style>
</head>


<body class="theme-clear">
    
    <header class="nav">
        <div class="nav-inner">
            <div class="brand">
                <div class="logo">‚õÖ</div>
                <div>weather</div>
            </div>
            <div class="quick-stats" id="quickStats">
                <div class="chip"><span class="dot"></span><span id="qs-temp">-- ¬∞C</span></div>
                <div class="chip"><span class="dot"></span><span id="qs-wind">Wind: -- km/h</span></div>
                <div class="chip"><span class="dot"></span><span id="qs-hum">Humidity: --%</span></div>
                <div class="chip"><span class="dot"></span><span id="qs-uv">UV: --</span></div>
            </div>
        </div>
    </header>

    <div class="bar">
        <input id="searchInput" placeholder="Search city (e.g., Hyderabad, London)" />
        <button id="searchBtn">Search</button>
        <button class="ghost" id="gpsBtn">üìç Use my location</button>
    </div>

    <main class="container">
        
        <section class="card">
            <h3 class="section-title">Current Weather</h3>
            <div class="current">
                <svg class="wx-icon" id="currentIcon" viewBox="0 0 24 24"></svg>
                <div>
                    <div class="city-line"><span id="place">‚Äî</span> <span id="timeLocal"></span></div>
                    <div class="hero-temp" id="tempNow">‚Äî ¬∞C</div>
                    <div class="meta" id="metaLine">Feels like ‚Äî ¬∞C ‚Ä¢ ‚Äî</div>
                </div>
            </div>
        </section>

        <section class="card">
            <h3 class="section-title">5‚ÄëDay Forecast</h3>
            <div class="grid" id="forecastGrid"></div>
        </section>

       
        <section class="card">
            <h3 class="section-title">Past 2 Days</h3>
            <div class="past-grid" id="pastGrid"></div>
        </section>

        <section class="card" style="grid-column: 1 / -1;">
            <h3 class="section-title">Sunrise & Sunset</h3>
            <div class="sun-grid" id="sunGrid"></div>
        </section>
    </main>

    <div class="note">Data: <a href="https://open-meteo.com/" target="_blank" rel="noreferrer">Open‚ÄëMeteo</a> ‚Ä¢
        Geocoding: Open‚ÄëMeteo ‚Ä¢ No API key needed.</div>

    <script>
        const WX = {
            map(code) {
                
                const groups = [
                    { codes: [0], label: 'Clear sky', group: 'clear' },
                    { codes: [1, 2, 3], label: 'Partly/Cloudy', group: 'cloudy' },
                    { codes: [45, 48], label: 'Fog', group: 'fog' },
                    { codes: [51, 53, 55, 56, 57], label: 'Drizzle', group: 'rain' },
                    { codes: [61, 63, 65, 66, 67, 80, 81, 82], label: 'Rain', group: 'rain' },
                    { codes: [71, 73, 75, 77, 85, 86], label: 'Snow', group: 'snow' },
                    { codes: [95, 96, 99], label: 'Thunderstorm', group: 'thunder' },
                ];
                for (const g of groups) { if (g.codes.includes(code)) return g; }
                return { label: '‚Äî', group: 'clear' };
            },
            icon(group) {
              
                const path = {
                    clear: '<circle cx="12" cy="12" r="5" fill="currentColor"/>',
                    cloudy: '<path d="M7 15a4 4 0 0 1 0-8 5 5 0 0 1 9.7 1.6A4 4 0 1 1 17 19H8a3 3 0 0 1-1-5.8Z" fill="currentColor"/>',
                    rain: '<path d="M7 15a4 4 0 0 1 0-8 5 5 0 0 1 9.7 1.6A4 4 0 1 1 17 19H8a3 3 0 0 1-1-5.8Z" fill="currentColor"/><g stroke="currentColor" stroke-width="1.6" stroke-linecap="round"><line x1="9" y1="20" x2="8" y2="23"/><line x1="12" y1="20" x2="11" y2="23"/><line x1="15" y1="20" x2="14" y2="23"/></g>',
                    thunder: '<path d="M7 15a4 4 0 0 1 0-8 5 5 0 0 1 9.7 1.6A4 4 0 1 1 17 19H8a3 3 0 0 1-1-5.8Z" fill="currentColor"/><path d="M12 12l-3 5h2l-1 4 4-6h-2l2-3z" fill="currentColor"/>',
                    snow: '<path d="M7 15a4 4 0 0 1 0-8 5 5 0 0 1 9.7 1.6A4 4 0 1 1 17 19H8a3 3 0 0 1-1-5.8Z" fill="currentColor"/><g stroke="currentColor" stroke-width="1.6" stroke-linecap="round"><line x1="9" y1="21" x2="9" y2="23"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="15" y1="21" x2="15" y2="23"/></g>',
                    fog: '<rect x="4" y="11" width="16" height="2" fill="currentColor"/><rect x="3" y="15" width="18" height="2" fill="currentColor"/>'
                };
                return `<svg class="wx-icon" viewBox="0 0 24 24" aria-hidden="true">${path[group] || path.clear}</svg>`;
            },
            theme(group) {
                return {
                    clear: 'theme-clear', cloudy: 'theme-cloudy', rain: 'theme-rain', thunder: 'theme-thunder', snow: 'theme-snow', fog: 'theme-fog'
                }[group] || 'theme-clear';
            }
        };

        
        async function geocodeCity(q) {
            const url = `https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(q)}&count=1&language=en&format=json`;
            const r = await fetch(url);
            if (!r.ok) throw new Error('Geocoding failed');
            const j = await r.json();
            if (!j.results || !j.results.length) throw new Error('City not found');
            const c = j.results[0];
            return { name: `${c.name}${c.admin1 ? ', ' + c.admin1 : ''}, ${c.country_code}`, latitude: c.latitude, longitude: c.longitude };
        }

      
        async function fetchForecast(lat, lon) {
            const params = new URLSearchParams({
                latitude: lat,
                longitude: lon,
                timezone: 'auto',
                current: ['temperature_2m', 'relative_humidity_2m', 'apparent_temperature', 'weather_code', 'wind_speed_10m', 'uv_index'].join(','),
                hourly: ['uv_index'].join(','),
                daily: ['temperature_2m_max', 'temperature_2m_min', 'uv_index_max', 'wind_speed_10m_max', 'weather_code', 'sunrise', 'sunset'].join(','),
                forecast_days: '7',
                past_days: '2'
            });
            const url = `https://api.open-meteo.com/v1/forecast?${params.toString()}`;
            const r = await fetch(url);
            if (!r.ok) throw new Error('Forecast failed');
            return await r.json();
        }

        
        const $ = sel => document.querySelector(sel);
        const forecastGrid = $('#forecastGrid');
        const pastGrid = $('#pastGrid');
        const sunGrid = $('#sunGrid');

        function setTheme(group) {
            document.body.className = WX.theme(group);
        }

        function fmtTime(dStr) {
            const d = new Date(dStr);
            return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }
        function fmtDate(dStr) {
            const d = new Date(dStr);
            return d.toLocaleDateString([], { weekday: 'short', month: 'short', day: 'numeric' });
        }

        function updateQuickStats(current) {
            $('#qs-temp').textContent = `${Math.round(current.temperature_2m)} ¬∞C`;
            $('#qs-wind').textContent = `Wind: ${Math.round(current.wind_speed_10m)} km/h`;
            $('#qs-hum').textContent = `Humidity: ${Math.round(current.relative_humidity_2m)}%`;
            $('#qs-uv').textContent = `UV: ${current.uv_index ?? '‚Äî'}`;
        }

        function renderCurrent(place, data) {
            const c = data.current;
            $('#place').textContent = place;
            $('#timeLocal').textContent = `‚Ä¢ ${new Date().toLocaleString([], { hour: '2-digit', minute: '2-digit' })}`;
            $('#tempNow').textContent = `${Math.round(c.temperature_2m)} ¬∞C`;
            const m = WX.map(c.weather_code);
            const iconSvg = WX.icon(m.group);
            $('#currentIcon').outerHTML = iconSvg;
            $('#metaLine').textContent = `Feels like ${Math.round(c.apparent_temperature)} ¬∞C ‚Ä¢ ${m.label}`;
            setTheme(m.group);
            updateQuickStats(c);
        }

        function renderForecast(daily) {
            forecastGrid.innerHTML = '';
           
            const now = new Date();
            const days = [];
            for (let i = 0; i < daily.time.length; i++) {
                const dt = new Date(daily.time[i]);
                // choose future days (>= tomorrow) up to 5
                if (dt >= new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1)) {
                    days.push(i);
                    if (days.length === 5) break;
                }
            }
            if (days.length < 5) {
                
                const start = Math.max(0, daily.time.length - 5);
                for (let i = start; i < daily.time.length; i++) days.push(i);
            }
            days.forEach(i => {
                const code = daily.weather_code[i];
                const m = WX.map(code);
                const html = `
          <div class="tile">
            <div class="day">${fmtDate(daily.time[i])}</div>
            <div>${WX.icon(m.group)}</div>
            <div class="range">${Math.round(daily.temperature_2m_min[i])}¬∞ / ${Math.round(daily.temperature_2m_max[i])}¬∞C</div>
            <div class="mini">Wind max: ${Math.round(daily.wind_speed_10m_max[i] || 0)} km/h</div>
            <div class="mini">UV max: ${daily.uv_index_max[i] ?? '‚Äî'}</div>
          </div>`;
                forecastGrid.insertAdjacentHTML('beforeend', html);
            });
        }

        function renderPast(daily) {
            pastGrid.innerHTML = '';
            
            const today = new Date(); today.setHours(0, 0, 0, 0);
            const idx = daily.time.map((t, i) => ({ t: new Date(t), i })).filter(o => o.t < today).slice(-2);
            idx.forEach(({ i }) => {
                const code = daily.weather_code[i];
                const m = WX.map(code);
                const html = `
          <div class="tile">
            <div class="day">${fmtDate(daily.time[i])}</div>
            <div>${WX.icon(m.group)}</div>
            <div class="range">${Math.round(daily.temperature_2m_min[i])}¬∞ / ${Math.round(daily.temperature_2m_max[i])}¬∞C</div>
            <div class="mini">Wind max: ${Math.round(daily.wind_speed_10m_max[i] || 0)} km/h</div>
          </div>`;
                pastGrid.insertAdjacentHTML('beforeend', html);
            });
            if (!pastGrid.children.length) { pastGrid.innerHTML = '<div class="mini">No past data available</div>'; }
        }

        function renderSun(daily) {
            sunGrid.innerHTML = '';
            daily.time.forEach((t, i) => {
                const html = `
          <div class="sun-item">
            <div class="day">${fmtDate(t)}</div>
            <div class="mini">Sunrise: ${fmtTime(daily.sunrise[i])}</div>
            <div class="mini">Sunset: ${fmtTime(daily.sunset[i])}</div>
          </div>`;
                sunGrid.insertAdjacentHTML('beforeend', html);
            });
        }

       
        async function loadByCoords(lat, lon, placeLabel = 'Your location') {
            try {
                document.title = 'Loading ‚Äî NeoWeather';
                const data = await fetchForecast(lat, lon);
                renderCurrent(placeLabel, data);
                renderForecast(data.daily);
                renderPast(data.daily);
                renderSun(data.daily);
                document.title = `${placeLabel} ‚Äî NeoWeather`;
            } catch (e) {
                alert(e.message || 'Failed to load data');
            }
        }

        async function searchCity() {
            const q = document.getElementById('searchInput').value.trim();
            if (!q) return alert('Enter a city');
            try {
                const geo = await geocodeCity(q);
                await loadByCoords(geo.latitude, geo.longitude, geo.name);
            } catch (e) { alert(e.message || 'Search failed'); }
        }

        
        let watchId = null;
        function enableGPS() {
            if (!('geolocation' in navigator)) return alert('Geolocation not supported');
            if (watchId) { navigator.geolocation.clearWatch(watchId); watchId = null; }
            watchId = navigator.geolocation.watchPosition(async (pos) => {
                const { latitude, longitude } = pos.coords;
                await loadByCoords(latitude, longitude, 'üìç Live location');
            }, (err) => {
                console.warn(err);
                alert('Location permission denied or unavailable');
            }, { enableHighAccuracy: true, maximumAge: 30_000, timeout: 15_000 });
        }

        
        document.getElementById('searchBtn').addEventListener('click', searchCity);
        document.getElementById('searchInput').addEventListener('keydown', (e) => { if (e.key === 'Enter') searchCity(); });
        document.getElementById('gpsBtn').addEventListener('click', enableGPS);

        
        if ('geolocation' in navigator) {
            navigator.geolocation.getCurrentPosition((pos) => {
                loadByCoords(pos.coords.latitude, pos.coords.longitude, 'üìç Your location');
            }, () => {
                
                geocodeCity('Hyderabad').then(g => loadByCoords(g.latitude, g.longitude, g.name));
            });
        } else {
            geocodeCity('Hyderabad').then(g => loadByCoords(g.latitude, g.longitude, g.name));
        }
       
       
    </script>
</body>

</html>